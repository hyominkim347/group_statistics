# PRD: 그룹 통계 대시보드 (Group Statistics Dashboard)

**Version:** 1.1
**Last Updated:** 2026-01-06
**Status:** Draft
**Author:** Product Team

---

## 1. 개요 (Overview)

### 1.1 배경 및 문제 정의
조직 내 다양한 그룹(부서, 팀)이 LLM 서비스를 사용하고 있으나, 현재 그룹별 사용 현황을 파악하기 어렵습니다. 이로 인해:
- 비용 분배의 근거 데이터 부재
- 리소스 최적화 기회 식별 어려움
- 그룹 간 사용량 비교 불가

### 1.2 솔루션
**그룹 통계 대시보드**는 관리자가 그룹별 LLM 사용량을 한눈에 파악하고, 데이터 기반 의사결정을 내릴 수 있도록 지원하는 분석 도구입니다.

### 1.3 목표
| 목표 | 설명 |
|------|------|
| 가시성 확보 | 그룹별 LLM 리소스 사용량의 투명한 모니터링 |
| 비용 관리 | 데이터 기반 비용 분배 및 예산 수립 지원 |
| 최적화 기회 | 사용 패턴 분석을 통한 효율화 인사이트 제공 |

### 1.4 타겟 사용자
- **주 사용자:** 조직 관리자, 재무 담당자
- **부 사용자:** 그룹 리더, 팀장

---

## 2. 핵심 기능 (Key Features)

### 2.1 통계 대시보드 네비게이션
세 개의 탭으로 구성된 통합 통계 환경을 제공합니다:

| 탭 | 목적 | 핵심 인사이트 |
|----|------|--------------|
| **사용량 (Usage)** | 전체 서비스 사용 현황 파악 | 앱별 요청 수, 크레딧 소비, LLM 호출 추이 |
| **멤버 수 (Member Count)** | 사용자 활동 패턴 분석 | 일별 활성 멤버, 개인별 랭킹 |
| **그룹 통계 (Group)** | 그룹 단위 비교 분석 | 그룹별 순위, 사용량 비교, 상세 지표 |

### 2.2 그룹 통계 주요 기능

#### A. 요약 대시보드
전체 현황을 3개의 핵심 지표로 요약 제공
- 총 크레딧 사용량 (Total Project Credits)
- 총 요청 수 (Total Project Requests)
- 활성 멤버 수 (Total Active Members)

#### B. 시각적 인사이트 (Visual Insights)
4가지 관점의 Top 7 그룹 비교 차트
- 크레딧 사용량 순위
- 요청 수 순위
- LLM 호출 수 순위
- 활성 멤버 수 순위

#### C. 상세 데이터 테이블
모든 그룹의 상세 지표를 정렬/페이지네이션과 함께 제공

#### D. 필터링 및 내보내기
- 그룹별 필터링
- 기간 설정 (최대 12개월)
- CSV 내보내기

---

## 3. 사용자 시나리오 (User Scenarios)

### 3.1 전체 현황 파악

#### 시나리오 1: 월간 사용량 요약 확인
> **"이번 달 전체 그룹의 LLM 사용 현황이 어떻게 되지?"**

**사용자 여정:**
1. 관리자는 통계 페이지에서 '그룹 통계' 탭을 선택한다
2. 상단의 **요약 카드 영역**에서 전체 크레딧 사용량, 총 요청 수, 활성 멤버 수를 **한눈에 확인**한다
3. 별도의 클릭이나 조작 없이 핵심 지표를 즉시 파악할 수 있다

**기대 결과:**
- 대시보드 진입 시 3개의 요약 카드가 즉시 표시됨
- 각 카드에는 숫자와 함께 한글 보조 설명 제공

---

#### 시나리오 2: 특정 기간 데이터 조회
> **"지난 분기(3개월) 동안의 사용량을 확인하고 싶어"**

**사용자 여정:**
1. 관리자는 우측 상단의 **날짜 선택기**를 클릭한다
2. 시작일과 종료일을 선택하여 원하는 기간을 설정한다
3. 선택 즉시 모든 차트와 테이블이 해당 기간 데이터로 **자동 갱신**된다

**기대 결과:**
- 기간 변경 시 페이지 새로고침 없이 데이터 즉시 반영
- 잘못된 기간 입력 시 인라인 에러 메시지 표시
  - 종료일이 시작일보다 이전: "End date must be after start date."
  - 12개월 초과: "Maximum query period is 12 months."

---

### 3.2 그룹 간 비교 분석

#### 시나리오 3: 상위 그룹 파악
> **"어떤 그룹이 LLM을 가장 많이 사용하고 있지?"**

**사용자 여정:**
1. 관리자는 **Visual Insights 섹션**의 4개 차트를 스캔한다
2. 'Top Groups by Credit Usage' 차트에서 **1위 그룹이 강조 색상**으로 표시되어 즉시 식별된다
3. 다른 차트들을 통해 요청 수, LLM 호출 수, 활성 멤버 관점에서도 순위를 비교한다

**기대 결과:**
- 각 차트는 상위 7개 그룹만 표시하여 정보 과부하 방지
- 1위 그룹은 브랜드 컬러로 강조, 나머지는 회색 계열로 표시
- 차트 호버 시 상세 수치가 툴팁으로 표시됨

---

#### 시나리오 4: 전체 그룹 상세 비교
> **"모든 그룹의 상세 사용량을 비교하고 싶어"**

**사용자 여정:**
1. 관리자는 페이지 하단의 **Group Usage Detail 테이블**로 스크롤한다
2. 컬럼 헤더를 클릭하여 **원하는 기준으로 정렬**한다 (예: 평균 크레딧 순)
3. 페이지네이션을 통해 전체 그룹을 순차적으로 확인한다

**기대 결과:**
- 모든 컬럼(순위, 그룹명, 멤버 수, 활성 멤버, 요청 수, 평균 크레딧, 총 크레딧)에서 정렬 가능
- 현재 정렬 기준과 방향이 UI에 명확히 표시됨
- 페이지당 10개 항목, 현재 페이지 위치 표시

---

### 3.3 특정 그룹 분석

#### 시나리오 5: 단일 그룹 심층 분석
> **"Marketing Team의 사용량만 따로 보고 싶어"**

**사용자 여정:**
1. 관리자는 좌측 상단의 **그룹 선택 드롭다운**을 클릭한다
2. 검색창에 'Marketing'을 입력하여 **그룹을 빠르게 검색**한다
3. 'Marketing Team'을 선택하면 **전체 대시보드가 해당 그룹 데이터만 표시**한다
4. 분석 완료 후 X 버튼을 클릭하여 필터를 해제한다

**기대 결과:**
- 그룹 검색 시 부분 일치 지원 (대소문자 무관)
- 필터 적용 시 시각적 표시 (필터 태그 또는 배지)
- 요약 카드, 차트, 테이블 모두 선택된 그룹 데이터만 반영

---

### 3.4 데이터 활용

#### 시나리오 6: 리포트용 데이터 추출
> **"경영진 보고를 위해 그룹별 사용량 데이터를 Excel로 정리해야 해"**

**사용자 여정:**
1. 관리자는 원하는 기간과 필터를 설정한다
2. 우측 상단의 **CSV Export 버튼**을 클릭한다
3. 로딩 인디케이터가 표시되고, 완료 시 **파일이 자동 다운로드**된다

**기대 결과:**
- 파일명: `GroupStatistics_{시작일}_{종료일}.csv`
- Excel에서 한글이 깨지지 않음 (UTF-8 with BOM)
- 포함 데이터: 순위, 그룹명, 총 멤버, 활성 멤버, 요청 수, LLM 호출 수, 크레딧

---

### 3.5 데이터 이해

#### 시나리오 7: 집계 기준 이해
> **"다중 소속 멤버의 사용량은 어떻게 집계되는 거지?"**

**사용자 여정:**
1. 관리자는 대시보드 상단의 **파란색 안내 배너**를 확인한다
2. 세 가지 핵심 집계 정책을 읽고 데이터 해석 방법을 이해한다:
   - 현재 멤버 구성 기준 집계
   - 다중 소속 멤버는 모든 그룹에 중복 집계
   - 그룹 미지정 멤버는 'Others'로 분류

**기대 결과:**
- 안내 배너는 항상 표시되어 데이터 오해 방지
- Info 아이콘과 함께 시각적으로 구분됨
- 간결하면서도 명확한 문구로 작성

---

## 4. 데이터 집계 정책 (Data Policies)

### 4.1 핵심 정책 요약

| 정책 | 설명 | 사용자 영향 |
|------|------|------------|
| **현재 기준 집계** | 현재 시점의 멤버-그룹 매핑 기준 | 과거 그룹 이동 이력 미반영 |
| **전체 귀속 (Full Attribution)** | 다중 소속 멤버는 모든 그룹에 100% 집계 | 그룹 합계 ≠ 전체 합계 |
| **Others 분류** | 그룹 미지정 멤버는 'Others'로 자동 분류 | 랭킹에서 제외, 합계에는 포함 |

### 4.2 다중 그룹 소속 처리 상세

**정책:** 다중 그룹 소속 멤버의 사용량은 **소속된 모든 그룹에 100% 중복 집계**됩니다.

```
예시:
멤버 A가 Marketing Team과 R&D Division에 동시 소속
→ 멤버 A의 100 크레딧 사용 시:
  - Marketing Team: +100 크레딧
  - R&D Division: +100 크레딧
```

**정책 선택 근거:**
- 각 그룹의 실제 리소스 기여도를 명확히 파악 가능
- 1/N 분할 방식 대비 그룹별 책임 소재 명확화
- 그룹 간 공정한 비교 가능

**주의사항:**
- 그룹별 통계 합계는 전체 프로젝트 통계와 일치하지 않을 수 있음
- 이는 중복 집계로 인한 정상적인 현상임

### 4.3 활성 멤버 판정

**정의:** 설정된 조회 기간 내에 **최소 1회 이상 요청**을 수행한 멤버

| 구분 | 활성 여부 |
|------|----------|
| 기간 내 요청 있음 | 활성 (Active) |
| 기간 내 요청 없음 | 비활성 (Inactive) |

### 4.4 랭킹 정책

| 항목 | 정책 |
|------|------|
| **기본 정렬** | 크레딧 사용량 내림차순 |
| **동점 처리** | 기존 순서 유지 (안정 정렬) |
| **Others 그룹** | 랭킹에서 제외 |

**랭킹 표시 규칙:**
- 1~3위: 트로피 아이콘 (금/은/동)
- 4위 이하: 숫자 표시

---

## 5. Key Metrics (핵심 지표)

### 5.1 그룹 레벨 지표

| 지표명 | 정의 | 용도 |
|--------|------|------|
| **Total Members** | 그룹에 소속된 전체 멤버 수 | 그룹 규모 파악 |
| **Active Members** | 조회 기간 내 활동한 멤버 수 | 실제 사용률 파악 |
| **Activation Rate** | Active Members ÷ Total Members | 그룹 활성화 정도 (UI에 70% 이상 시 강조 표시) |
| **Total Requests** | 그룹 멤버들의 총 요청 횟수 | 서비스 이용 빈도 |
| **Total Credits** | 그룹의 총 크레딧 사용량 | 비용 파악 (핵심 랭킹 기준) |
| **Avg Credits/Member** | Total Credits ÷ Total Members | 멤버당 평균 비용, 효율성 비교 |
| **LLM Calls** | 백엔드 LLM API 호출 횟수 | 기술적 리소스 사용량 |

### 5.2 프로젝트 레벨 지표 (요약 카드)

| 지표명 | 집계 방식 | 표시 위치 |
|--------|----------|----------|
| **Total Project Credits** | 모든 그룹 크레딧 합계 | 요약 카드 1 |
| **Total Project Requests** | 모든 그룹 요청 합계 | 요약 카드 2 |
| **Total Active Members** | 모든 그룹 활성 멤버 합계 | 요약 카드 3 |

### 5.3 지표 간 관계

```
Request → LLM Calls → Credits

1 Request = 1.2 ~ 2.5 LLM Calls (요청 유형에 따라 상이)
LLM Calls × 단가 = Credits
```

---

## 6. 화면 구성 및 인터랙션 가이드

### 6.1 페이지 레이아웃

```
┌─────────────────────────────────────────────────────────┐
│  통계 / Statistics                                       │
├─────────────────────────────────────────────────────────┤
│  [사용량]  [멤버 수]  [그룹 통계]  ← 탭 네비게이션         │
├─────────────────────────────────────────────────────────┤
│  ⓘ 데이터 집계 기준 안내 배너                             │
├─────────────────────────────────────────────────────────┤
│  [그룹 선택 ▼]              [📅 기간 선택] [CSV Export]  │
├─────────────────────────────────────────────────────────┤
│  ┌──────────┐ ┌──────────┐ ┌──────────┐                 │
│  │ Credits  │ │ Requests │ │ Active   │  ← 요약 카드     │
│  │  15,200  │ │  1,050   │ │   342    │                 │
│  └──────────┘ └──────────┘ └──────────┘                 │
├─────────────────────────────────────────────────────────┤
│  Visual Insights                                         │
│  ┌─────────────────┐ ┌─────────────────┐                │
│  │ Credit Usage    │ │ Requests        │  ← 2x2 차트    │
│  └─────────────────┘ └─────────────────┘                │
│  ┌─────────────────┐ ┌─────────────────┐                │
│  │ LLM Calls       │ │ Active Members  │                │
│  └─────────────────┘ └─────────────────┘                │
├─────────────────────────────────────────────────────────┤
│  Group Usage Detail                     [정렬 표시]      │
│  ┌─────────────────────────────────────────────────────┐│
│  │ Rank │ Group Name │ Members │ Active │ ... │ Credit ││
│  ├─────────────────────────────────────────────────────┤│
│  │  🥇  │ Marketing  │   45    │   38   │ ... │ 15,200 ││
│  │  🥈  │ R&D        │  120    │   85   │ ... │ 11,500 ││
│  └─────────────────────────────────────────────────────┘│
│  [◀ 1 2 3 ▶]                                            │
└─────────────────────────────────────────────────────────┘
```

### 6.2 인터랙션 명세

#### 그룹 선택 드롭다운
| 액션 | 동작 |
|------|------|
| 클릭 | 드롭다운 메뉴 펼침 |
| 검색어 입력 | 실시간 필터링 (부분 일치) |
| 그룹 선택 | 전체 대시보드 필터 적용, 드롭다운 닫힘 |
| X 버튼 클릭 | 필터 해제, 전체 그룹 표시 |
| 외부 클릭 | 드롭다운 닫힘 |

#### 날짜 선택기
| 액션 | 동작 |
|------|------|
| 시작일/종료일 변경 | 즉시 유효성 검증, 데이터 자동 갱신 |
| 유효하지 않은 기간 | 입력 필드 빨간 테두리, 인라인 에러 메시지 |

#### 데이터 테이블
| 액션 | 동작 |
|------|------|
| 컬럼 헤더 클릭 | 해당 컬럼 기준 정렬 토글 (asc ↔ desc) |
| 정렬 변경 시 | 첫 페이지로 자동 이동 |
| 페이지 버튼 클릭 | 해당 페이지로 이동 |
| 행 호버 | 배경색 변경으로 시각적 피드백 |

#### 차트
| 액션 | 동작 |
|------|------|
| 바 호버 | 툴팁 표시 (그룹명, 수치, 멤버 정보) |

### 6.3 반응형 동작

| 브레이크포인트 | 레이아웃 변경 |
|---------------|--------------|
| **Desktop (≥1280px)** | 2x2 차트 그리드, 전체 테이블 컬럼 |
| **Tablet (768-1279px)** | 2x2 차트 그리드 유지, 일부 컬럼 축소 |
| **Mobile (<768px)** | 1열 차트, 수평 스크롤 테이블 |

### 6.4 로딩 및 상태 표시

| 상태 | 표시 방식 |
|------|----------|
| 초기 로딩 | 스켈레톤 UI |
| 필터 적용 중 | 컴포넌트별 로딩 인디케이터 (페이지 블로킹 없음) |
| CSV 내보내기 중 | 버튼 내 스피너, 버튼 비활성화 |
| 데이터 없음 | "No groups found." 메시지 |
| 에러 발생 | 인라인 에러 메시지 |

---

## 7. 디자인 가이드라인

### 7.1 색상 시스템

| 용도 | 색상 코드 | 사용처 |
|------|----------|--------|
| Primary | `#7420FF` | CTA 버튼, 활성 탭, 1위 차트 바 |
| Primary Hover | `#6010E0` | 버튼 호버 상태 |
| Credit Chart | `#7420FF` | 크레딧 차트 1위 바 |
| Request Chart | `#3B82F6` | 요청 차트 1위 바 |
| LLM Calls Chart | `#10B981` | LLM 호출 차트 1위 바 |
| Active Chart | `#F59E0B` | 활성 멤버 차트 1위 바 |
| Inactive Bars | `#E5E7EB` | 2위 이하 차트 바 |
| Background | `#F6F5F8` | 페이지 배경 |
| Card Background | `#FFFFFF` | 카드, 테이블 배경 |
| Info Banner | `#EFF6FF` | 안내 배너 배경 (파란색 계열) |
| Error | `#EF4444` | 에러 메시지, 유효성 검증 실패 |

### 7.2 랭킹 뱃지

| 순위 | 스타일 |
|------|--------|
| 1위 | 금색 배경 (`#FEF3C7`), 금색 트로피 (`#CA8A04`) |
| 2위 | 회색 배경 (`#F3F4F6`), 은색 트로피 (`#6B7280`) |
| 3위 | 주황 배경 (`#FFEDD5`), 동색 트로피 (`#C2410C`) |
| 4위+ | 숫자만 표시, 회색 (`#6B7280`) |

### 7.3 활성 멤버 표시

| 조건 | 스타일 |
|------|--------|
| 활성률 70% 이상 | 초록 배경 (`#DCFCE7`), 초록 텍스트 (`#15803D`) |
| 활성률 70% 미만 | 회색 배경 (`#F3F4F6`), 회색 텍스트 (`#4B5563`) |

---

## 8. FAQ (자주 묻는 질문)

### 8.1 데이터 관련

**Q1. 그룹별 통계 합계가 전체 프로젝트 통계와 다른 이유는?**
> 다중 그룹 소속 멤버의 사용량이 각 그룹에 100% 중복 집계되기 때문입니다. 이는 의도된 정책이며, 각 그룹의 실제 리소스 기여도를 명확히 파악하기 위함입니다.

**Q2. 과거에 다른 그룹에 있던 멤버의 사용량은 어떻게 집계되나요?**
> 현재 시점의 그룹 배치를 기준으로 집계됩니다. 과거 그룹 이동 이력은 반영되지 않습니다.

**Q3. 'Others' 그룹은 무엇인가요?**
> 어떤 그룹에도 배정되지 않은 멤버들의 사용량을 집계한 가상 그룹입니다. 랭킹에서는 제외되지만, 전체 통계에는 포함됩니다.

**Q4. 활성 멤버의 기준은?**
> 설정된 조회 기간 내에 최소 1회 이상 요청을 수행한 멤버입니다.

### 8.2 기능 관련

**Q5. 최대 몇 개월까지 조회할 수 있나요?**
> 최대 12개월(365일)까지 조회 가능합니다.

**Q6. CSV 파일이 Excel에서 깨져 보여요.**
> UTF-8 with BOM 인코딩을 적용하여 Excel 호환성을 확보했습니다. 문제가 지속되면 Excel에서 '데이터 > 텍스트에서' 기능으로 UTF-8 인코딩을 선택하여 열어보세요.

**Q7. 차트에 상위 7개 그룹만 표시되는 이유는?**
> 정보 과부하를 방지하고 핵심 인사이트에 집중하기 위함입니다. 전체 그룹 데이터는 하단 테이블에서 확인할 수 있습니다.

### 8.3 정책 관련

**Q8. 1/N 분할 방식으로 집계할 수는 없나요?**
> 현재는 전체 귀속(Full Attribution) 방식만 지원합니다. 1/N 분할 방식은 향후 개선 사항으로 검토 중입니다.

**Q9. 그룹 계층 구조(부서 > 팀)를 지원하나요?**
> 현재는 단일 레벨 그룹만 지원합니다. 계층 구조 지원은 향후 로드맵에 포함되어 있습니다.

---

## 9. 기술 고려사항

### 9.1 성능 요구사항

| 항목 | 목표 | 비고 |
|------|------|------|
| 초기 로딩 | 2초 이내 | 스켈레톤 UI로 체감 속도 개선 |
| 필터 적용 | 500ms 이내 | 클라이언트 사이드 필터링 |
| CSV 내보내기 | 3초 이내 | 1000개 그룹 기준 |

### 9.2 접근성 (A11y)

| 항목 | 요구사항 |
|------|----------|
| 키보드 | 모든 인터랙티브 요소 Tab 접근 가능 |
| 스크린 리더 | ARIA 레이블 적용, 테이블 헤더 연결 |
| 색상 대비 | WCAG 2.1 AA 기준 충족 (4.5:1 이상) |
| 포커스 | 명확한 포커스 인디케이터 표시 |

### 9.3 브라우저 지원

| 브라우저 | 최소 버전 |
|----------|----------|
| Chrome | 최신 2개 버전 |
| Firefox | 최신 2개 버전 |
| Safari | 최신 2개 버전 |
| Edge | 최신 2개 버전 |

---

## 10. 향후 로드맵

### Phase 2 (예정)
- [ ] 이력 기반 집계 옵션 (Historical Attribution)
- [ ] 1/N 분할 집계 모드 선택
- [ ] 트렌드 비교 (전월 대비, 전년 동기 대비)

### Phase 3 (검토 중)
- [ ] 그룹 계층 구조 지원 (부서 > 팀)
- [ ] 사용량 알림 임계치 설정
- [ ] 그룹 간 비용 분담 리포트
- [ ] 대시보드 커스터마이징

---

## 11. 부록

### 11.1 용어 정의

| 용어 | 정의 |
|------|------|
| **Credit** | LLM API 사용에 따른 비용 단위. 실제 과금의 기준이 됨 |
| **Request** | 사용자가 시스템에 보낸 질의 1건 |
| **LLM Call** | 백엔드에서 LLM API를 호출한 횟수. 1 Request가 여러 LLM Call을 발생시킬 수 있음 |
| **Active Member** | 조회 기간 내 최소 1회 이상 요청을 수행한 멤버 |
| **Full Attribution** | 다중 그룹 소속 멤버의 사용량을 모든 소속 그룹에 100% 집계하는 방식 |

### 11.2 관련 문서
- 디자인 시스템 가이드
- API 명세서
- 사용량 통계 탭 PRD
- 멤버 활동 탭 PRD

### 11.3 변경 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|----------|
| 1.0 | 2026-01-06 | 초안 작성 |
| 1.1 | 2026-01-06 | 사용자 시나리오 중심 재구성, Key Metrics/FAQ 추가 |
